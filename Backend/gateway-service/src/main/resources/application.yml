server:
  port: 8080

spring:
  application:
    name: gateway-service

  cloud:
    gateway:
      # default-filters:
      #   - RemoveHopByHopHeaders=
      routes:
        - id: appointments-route
          uri: lb://appointment-service
          predicates:
            - Path=/api/appointments/**
        - id: auth-route
          uri: lb://auth-service
          predicates:
            - Path=/api/auth/**,/api/admin/**
      globalcors:
        corsConfigurations:
          '[/**]':
            allowedOrigins: ${app.cors.allowed-origins:["http://localhost:3000"]}
            allowedMethods: ["GET","POST","PUT","PATCH","DELETE","OPTIONS"]
            allowedHeaders: ["*"]
            exposedHeaders: ["*"]
            allowCredentials: true
            maxAge: 3600

  security:
    oauth2:
      resourceserver:
        jwt:
          # Provide your Keycloak realm issuer and JWK set URIs (Docker-friendly defaults)
          issuer-uri: ${SECURITY_OAUTH2_ISSUER_URI:http://keycloak:8080/realms/medinsight}
          jwk-set-uri: ${SECURITY_OAUTH2_JWK_SET_URI:http://keycloak:8080/realms/medinsight/protocol/openid-connect/certs}

eureka:
  client:
    register-with-eureka: true
    fetch-registry: true
    service-url:
      defaultZone: ${EUREKA_CLIENT_SERVICEURL_DEFAULTZONE:http://discovery-service:8761/eureka/}
  instance:
    prefer-ip-address: true

# Springdoc OpenAPI
springdoc:
  swagger-ui:
    path: /swagger-ui.html
  api-docs:
    path: /v3/api-docs

# Actuator
management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: when_authorized

# Custom app configuration
app:
  cors:
    # List of allowed origins for CORS (React frontend, etc.)
    allowed-origins:
      - http://localhost:3000
